{% load i18n static unipark_tags %}
<header x-data="{ menuOpen: false, profileOpen: false }"
        @keydown.escape.window="profileOpen = false"
        class="navbar glass-nav fixed inset-x-0 top-0 z-50">
    <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4 lg:px-6">
        <div class="flex items-center gap-3">
            <a href="{% url 'parking:home' %}" class="group inline-flex items-center gap-2 text-lg font-semibold tracking-tight">
                <span class="relative flex h-11 w-11 items-center justify-center rounded-2xl bg-gradient-to-br from-primary to-primary/60 shadow-neon transition-transform duration-300 group-hover:-translate-y-0.5">
                    <span class="absolute inset-0 rounded-2xl bg-white/15 blur-md"></span>
                    <svg class="relative h-6 w-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                              d="M12 3a6 6 0 0 0-6 6c0 4.5 6 10.5 6 10.5S18 13.5 18 9a6 6 0 0 0-6-6z"/>
                        <circle cx="12" cy="9" r="2.6" stroke-width="1.4"/>
                    </svg>
                </span>
                <span class="font-display text-xl text-surface-900 dark:text-white">
                    UniPark
                </span>
            </a>
        </div>

        <nav class="hidden items-center gap-1 text-sm font-medium lg:flex">
            <a href="{% url 'parking:home' %}"
               class="nav-link {% nav_active 'parking:home' %}">
                {% trans "Home" %}
            </a>
            <a href="{% url 'parking:find_parking' %}"
               class="nav-link {% nav_active 'parking:find_parking' %}">
                {% trans "Find Parking" %}
            </a>
            <a href="{% url 'parking:dashboard' %}"
               class="nav-link {% nav_active 'parking:dashboard' %}">
                {% trans "Dashboard" %}
            </a>
            <a href="{% url 'parking:settings' %}"
               class="nav-link {% nav_active 'parking:settings' %}">
                {% trans "Settings" %}
            </a>
        </nav>

        <div class="flex items-center gap-3">
            {% if user.is_authenticated %}
                <div class="relative">
                    <button type="button"
                            @click="profileOpen = !profileOpen"
                            @keyup.space.prevent="profileOpen = !profileOpen"
                            class="group flex h-11 w-11 items-center justify-center rounded-full bg-gradient-to-br from-primary to-primary/50 text-white shadow-lg shadow-primary/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                        <span class="sr-only">{% trans "Open profile menu" %}</span>
                        <span class="font-semibold">
                            {{ user.first_name|first|default:user.username|first|upper }}
                        </span>
                    </button>
                    <div x-cloak
                         x-show="profileOpen"
                         x-transition
                         @click.outside="profileOpen = false"
                         class="profile-menu absolute {{ LANGUAGE_BIDI|yesno:'right-0,left-0' }} mt-4 w-60">
                        <p class="profile-menu__name">
                            {{ user.get_full_name|default:user.username }}
                        </p>
                        <div class="profile-menu__list">
                            <a href="{% url 'parking:dashboard' %}"
                               class="profile-link">{% trans "Dashboard" %}</a>
                            <a href="{% url 'parking:settings' %}"
                               class="profile-link">{% trans "Preferences" %}</a>
                            <form method="post" action="{% url 'parking:logout' %}">
                                {% csrf_token %}
                                <button type="submit" class="profile-link profile-link--danger w-full text-left">
                                    {% trans "Log out" %}
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            {% else %}
                <a href="{% url 'parking:login' %}"
                   class="hidden rounded-full border border-white/20 px-4 py-2 text-sm font-semibold text-white/90 transition hover:text-white lg:inline-flex">
                    {% trans "Log in" %}
                </a>
                <a href="{% url 'parking:signup' %}"
                   class="hidden rounded-full bg-accent px-4 py-2 text-sm font-semibold text-surface-900 shadow-lg shadow-accent/30 transition hover:shadow-accent/60 lg:inline-flex">
                    {% trans "Create account" %}
                </a>
            {% endif %}

            <button type="button"
                    class="inline-flex h-10 w-10 items-center justify-center rounded-full border border-white/10 text-white lg:hidden"
                    @click="menuOpen = !menuOpen"
                    :aria-expanded="menuOpen">
                <svg x-show="!menuOpen" class="h-5 w-5" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                          d="M4 7h16M4 12h16M4 17h16"/>
                </svg>
                <svg x-cloak x-show="menuOpen" class="h-5 w-5" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                          d="m6 6 12 12M6 18 18 6"/>
                </svg>
            </button>
        </div>
    </div>

    <div x-cloak x-show="menuOpen" x-transition
         class="border-t border-white/10 bg-white/95 px-4 pb-4 pt-2 shadow-inner dark:bg-surface-900/95 lg:hidden">
        <nav class="flex flex-col gap-2 text-base font-semibold">
            <a href="{% url 'parking:home' %}" class="mobile-link {% nav_active 'parking:home' %}">
                {% trans "Home" %}
            </a>
            <a href="{% url 'parking:find_parking' %}" class="mobile-link {% nav_active 'parking:find_parking' %}">
                {% trans "Find Parking" %}
            </a>
            <a href="{% url 'parking:dashboard' %}" class="mobile-link {% nav_active 'parking:dashboard' %}">
                {% trans "Dashboard" %}
            </a>
            <a href="{% url 'parking:settings' %}" class="mobile-link {% nav_active 'parking:settings' %}">
                {% trans "Settings" %}
            </a>
        </nav>
        <div class="mt-4 grid gap-2">
            {% if user.is_authenticated %}
                <a href="{% url 'parking:dashboard' %}" class="mobile-link">
                    {% trans "Dashboard" %}
                </a>
                <form method="post" action="{% url 'parking:logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="mobile-link text-left text-red-500 hover:text-red-400">
                        {% trans "Log out" %}
                    </button>
                </form>
            {% else %}
                <a href="{% url 'parking:login' %}" class="mobile-link">{% trans "Log in" %}</a>
                <a href="{% url 'parking:signup' %}"
                   class="rounded-xl bg-gradient-to-r from-primary to-primary/60 px-5 py-3 text-center text-sm font-semibold text-white shadow-lg shadow-primary/40">
                    {% trans "Create account" %}
                </a>
            {% endif %}
        </div>
    </div>
</header>

