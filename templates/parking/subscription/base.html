{% extends 'base.html' %}

{% block content %}
<div class="container my-4">
    <div class="row">
        <div class="col-md-3">
            <div class="list-group">
                <a href="{% url 'parking:subscription_plans' %}" class="list-group-item list-group-item-action {% if active_tab == 'plans' %}active{% endif %}">
                    <i class="bi bi-grid"></i> Plans
                </a>
                <a href="{% url 'parking:subscription_history' %}" class="list-group-item list-group-item-action {% if active_tab == 'history' %}active{% endif %}">
                    <i class="bi bi-clock-history"></i> History
                </a>
                {% if current_subscription %}
                <a href="{% url 'parking:subscription_details' current_subscription.id %}" class="list-group-item list-group-item-action {% if active_tab == 'details' %}active{% endif %}">
                    <i class="bi bi-gear"></i> Manage Subscription
                </a>
                {% endif %}
            </div>
        </div>
        <div class="col-md-9">
            <div class="card shadow">
                <div class="card-header bg-light">
                    <h4 class="mb-0">{% block subscription_title %}{% endblock %}</h4>
                    <p class="text-muted mb-0">{% block subscription_subtitle %}{% endblock %}</p>
                </div>
                <div class="card-body">
                    {% block subscription_content %}{% endblock %}
                </div>
            </div>
        </div>
    </div>
</div>

{% block subscription_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle payment method selection and show coming soon modal
    const paymentModal = document.getElementById('paymentModal');
    if (paymentModal) {
        // Update modal content when shown
        paymentModal.addEventListener('show.bs.modal', function(event) {
            const button = event.relatedTarget;
            const planName = button.getAttribute('data-plan-name');
            const planPrice = button.getAttribute('data-plan-price');
            
            const nameEl = this.querySelector('.selected-plan-name');
            const priceEl = this.querySelector('.selected-plan-price');
            
            nameEl.textContent = planName;
            priceEl.textContent = `$${planPrice}/month`;
        });

        // Handle payment method selection
        const paymentMethods = document.querySelectorAll('.payment-method');
        paymentMethods.forEach(method => {
            method.addEventListener('click', function() {
                const paymentType = this.dataset.method;
                const bsPaymentModal = bootstrap.Modal.getInstance(paymentModal);
                bsPaymentModal.hide();

                // Create and show the coming soon modal
                const comingSoonModal = document.createElement('div');
                comingSoonModal.classList.add('modal', 'fade');
                comingSoonModal.innerHTML = `
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Coming Soon!</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body text-center p-5">
                                <i class="bi bi-clock-history display-1 text-warning mb-3"></i>
                                <h4>Payment Gateway Coming Soon</h4>
                                <p class="text-muted">We're working hard to bring you secure ${paymentType === 'paypal' ? 'PayPal' : 'credit card'} payments. Please check back soon!</p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(comingSoonModal);
                const bsComingSoonModal = new bootstrap.Modal(comingSoonModal);
                bsComingSoonModal.show();
                
                comingSoonModal.addEventListener('hidden.bs.modal', function() {
                    this.remove();
                });
            });
        });
    }
});
</script>
{% endblock %}
{% endblock %}